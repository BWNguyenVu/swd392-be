# Use an official OpenJDK runtime as a parent image
FROM openjdk:17-jdk-slim

# Set the working directory in the container
WORKDIR /usr/src/app

# Copy the jar file from the target directory to the working directory in the container
COPY target/myflower-0.0.1-SNAPSHOT.jar myflower-0.0.1-SNAPSHOT.jar

ENV AWS_ACCESS_KEY=${AWS_ACCESS_KEY}
ENV AWS_PRIVATE_KEY=${AWS_PRIVATE_KEY}
ENV AWS_REGION=${AWS_REGION}
ENV AWS_BUCKET_NAME=${AWS_BUCKET_NAME}
ENV CONNECTION_STRING_POSTGRES_PROD=${CONNECTION_STRING_POSTGRES_PROD}
ENV POSTGRES_USERNAME=${POSTGRES_USERNAME}
ENV POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
ENV EMAIL_USERNAME=${EMAIL_USERNAME}
ENV EMAIL_PASSWORD=${EMAIL_PASSWORD}
ENV KAFKA_BOOTSTRAP_SERVER=${KAFKA_BOOTSTRAP_SERVER}
ENV REDIS_HOST=${REDIS_HOST}
ENV REDIS_PASSWORD=${REDIS_PASSWORD}
ENV GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
ENV GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
ENV JWT_SECRET=${JWT_SECRET}
ENV PUBLIC_API=${PUBLIC_API}

# Expose the port the application runs on
EXPOSE 6868

# Run the jar file
ENTRYPOINT ["java", "-jar", "myflower-0.0.1-SNAPSHOT.jar"]
